{"critical": [{"issue": "Embedding Model Loading Race Condition", "location": "apps/mcp-server/src/", "impact": "Multiple tools loading embeddings simultaneously will cause memory issues and race conditions", "fix": "Implement singleton embedding service with initialization queue"}, {"issue": "Float32Array Endianness Mismatch", "location": "data/embeddings.bin files", "impact": "Embeddings saved on one architecture won't load on another (Intel vs ARM)", "fix": "Store embeddings as JSON arrays or include endianness detection"}, {"issue": "Memory Leak in Vectra Index", "location": "packages/search/src/embeddings.ts", "impact": "LocalIndex.beginUpdate() never ends, causing memory bloat and eventual OOM", "fix": "Every beginUpdate() must have corresponding endUpdate() in finally block"}, {"issue": "Zod Schema Runtime Validation Overhead", "location": "apps/mcp-server/src/tools/handlers/*.ts", "impact": "Validating every search result through Zod kills performance (~10x slower)", "fix": "Use Zod for input only, trust pre-validated data from cache step"}, {"issue": "Missing File Lock During Cache Updates", "location": "apps/cache/src/download.ts", "impact": "MCP server reading data.json while cache app is writing will cause corrupted reads", "fix": "Implement file-based locking or atomic file replacement patterns"}, {"issue": "Node Module Binary Compatibility", "location": "@xenova/transformers dependency", "impact": "Native binaries differ across architectures causing runtime failures", "fix": "Add platform-specific installation scripts and fallback to CPU-only mode"}, {"issue": "Circular Dependency Between Shared and Search Packages", "location": "packages/ directory structure", "impact": "Search package imports shared types, shared types need search interfaces for method signatures", "fix": "Extract interfaces to separate interfaces package or invert dependency direction"}, {"issue": "Incorrect Vectra API Usage", "location": "packages/search/src/embeddings.ts", "impact": "LocalIndex.addItem() signature mismatch - uses different parameter names than shown in design", "fix": "Check actual Vectra docs for addItem({id, vector, metadata}) vs addItem(item) pattern"}, {"issue": "Fuse.js Configuration Error", "location": "packages/search/src/fuzzy.ts", "impact": "threshold: 0.3 too permissive, will return too many irrelevant matches", "fix": "Use 0.2 default and tune based on actual data"}, {"issue": "Transformers Pipeline API Mismatch", "location": "@xenova/transformers usage", "impact": "pipeline() method signature differs from design - requires different initialization", "fix": "Use pipeline('feature-extraction', modelName) instead of constructor pattern"}, {"issue": "MCP SDK Tool Registration Pattern Wrong", "location": "apps/mcp-server/src/server.ts", "impact": "Tool handlers won't register properly with MCP server", "fix": "Use server.setRequestHandler() with proper schema conversion"}], "high": [{"issue": "Fix package.json scripts", "location": "01-wave-foundation.md", "impact": "Missing critical typecheck and lint scripts will break turbo monorepo pipeline", "fix": "Add missing scripts to individual packages"}, {"issue": "Add retry logic to download module", "location": "02-wave-data-pipeline.md download.ts", "impact": "API failures throw immediately instead of retrying transient failures", "fix": "Implement exponential backoff retry logic"}, {"issue": "Numerical stability in similarity functions", "location": "03-wave-search-engine.md similarity.ts", "impact": "Division by zero with zero vectors causes NaN propagation", "fix": "Add epsilon checks to prevent NaN"}, {"issue": "Async initialization missing in server context", "location": "04-wave-mcp-server.md server.ts", "impact": "Embedding model loading during first request causes poor startup behavior", "fix": "Load models during server startup with proper error handling"}, {"issue": "Missing signal handling in CLI", "location": "05-wave-cli-integration.md CLI commands", "impact": "Ctrl+C during cache operations leaves temporary files and connections", "fix": "Add graceful shutdown handling for SIGINT/SIGTERM"}, {"issue": "Git workflow rules undefined", "location": "00-overview.md", "impact": "Multiple developers modifying shared interfaces during parallel work causes merge conflicts", "fix": "Add explicit git workflow and coordination rules"}, {"issue": "Commander.js Action Handler Wrong Type", "location": "apps/cli/src/commands/cache.ts", "impact": "Action handler not properly async and missing error handling", "fix": "Use .action(async (options) => {...}) with proper try/catch"}, {"issue": "Consola Import Wrong", "location": "packages/shared/src/logger.ts", "impact": "Consola has different API than shown in design", "fix": "Use consola.withDefaults() or direct import, not constructor pattern"}, {"issue": "Zod to JSON Schema Conversion Missing", "location": "MCP tool schemas", "impact": "Zod schemas won't convert to MCP-compatible JSON schemas", "fix": "Use zod-to-json-schema library for proper conversion"}, {"issue": "Bunfig.toml Syntax Wrong", "location": "Root configuration", "impact": "Bun config syntax differs from what's shown, will cause startup failure", "fix": "Use proper [install] and [test] sections in bunfig.toml"}, {"issue": "Turbo.json Pipeline Config Missing", "location": "turbo.json", "impact": "Turbo won't know how to run tasks in correct order", "fix": "Add proper pipeline definitions and cache settings"}],   "syntax_errors": [{"issue": "TypeScript Enum Usage vs Const Assertion", "location": "packages/shared/src/constants.ts", "impact": "const {} as const pattern used incorrectly, TypeScript will throw", "fix": "Use proper enum or fix const assertion syntax"}, {"issue": "Async Function Without Await in TDD Examples", "location": "Multiple wave docs", "impact": "Test examples show async functions without await on calls", "fix": "Add proper await statements or make functions sync"}, {"issue": "Import Path Wrong for Shared Package", "location": "Multiple files", "impact": "@skippy/shared import won't resolve without proper workspace setup", "fix": "Ensure package.json has correct name and paths"}, {"issue": "ESLint Config Wrong Path", "location": ".eslintrc.json", "impact": "Config references files that don't exist yet", "fix": "Add path overrides or move files to correct locations"}, {"issue": "Missing Type Declarations", "location": "Multiple .ts files", "impact": "Functions without return types will fail strict TypeScript compilation", "fix": "Add explicit return types to all functions"}, {"issue": "Picocolors Import Wrong", "location": "CLI commands", "impact": "pc.* usage pattern differs from library API", "fix": "Use proper picocolors import and method names"}, {"issue": "fetch() Usage Missing Headers", "location": "apps/cache/src/download.ts", "impact": "API requests without proper headers will be rejected", "fix": "Add User-Agent, Accept, and API key headers"}, {"issue": "try/catch Without Type Guards", "location": "Multiple error handling examples", "impact": "Catching unknown error types without instanceof checks", "fix": "Add proper error type guards and error extraction"}, {"issue": "Map/Set Missing Size Checks", "location": "Various memory usage patterns", "impact": "Collections growing without bounds checks", "fix": "Add size limits and cleanup strategies"}]}, "observations": [{"pattern": "The design shows excellent technical choices but API signatures and library usage patterns need verification against actual documentation", "suggestion": "Create spike implementations for each major library to verify API usage before full implementation"}]}